/*! message_board 2015-08-09 */
function getData(){$.ajax({type:"GET",url:"/messenger",success:function(a){loadDisplay(a)}})}function loadDisplay(a){$(".display").empty();for(var b=0;b<a.length;b++)writeCard(a,b),$(".display .card").delay(10*b).slideDown();messageIndex=b}function updateData(){recalcTime(),$.ajax({type:"GET",url:"/messenger",success:function(a){updateDisplay(a)}})}function updateDisplay(a){for(var b=messageIndex;b<a.length;b++)writeCard(a,b),$(".display .card").first().hide().slideDown();messageIndex=b}function writeCard(a,b){$(".display").prepend('<div class="card"></div>');var c=$(".display .card").first();c.append('<div class="name">'+a[b].name+"</div>"),c.append('<div class="time" data-timestamp="'+a[b].timestamp+'">'+moment(a[b].timestamp).fromNow(!0)+"</div>"),c.append('<div class="message">'+a[b].message+"</div>")}function recalcTime(){$(".time").each(function(){var a=$(this).attr("data-timestamp");$(this).text(moment(a).fromNow(!0)),console.log($(this).prev().text())})}var messageIndex=0;moment.locale("en-my-settings",{relativeTime:{s:"%ds",m:"%dm",mm:"%dm",h:"%dh",hh:"%dh",d:"%dd",dd:"%dd",M:"%dm",MM:"%dm",y:"%dy",yy:"%dy"}}),$(document).ready(function(){$("#inputForm").submit(function(a){a.preventDefault();var b=$("#inputForm").serialize();console.log(b),$.ajax({type:"POST",url:"/messenger",data:b,success:function(){updateData()}})}),getData()});